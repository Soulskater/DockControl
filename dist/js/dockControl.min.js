angular.module("DockControl",["Attribute.Directives"]).constant("$alignment",{horizontal:"horizontal",vertical:"vertical",middle:"middle"}).constant("$orientation",{left:"left",right:"right",top:"top",bottom:"bottom",center:"center"}).directive("dock",["DockControl.PathService",function(t){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:t.templatesBaseUrl+"dock.tmpl.html",scope:{sizeChanged:"="},controller:"DockCtrl",link:function(t){function e(t){var e=0,n=0;do t.offset()&&(e+=t.offset().top||0,n+=t.offset().left||0),t=t.parent();while(t.length>0);return{top:e,left:n}}t.offset=e($(".panel-container"))}}}]),angular.module("Attribute.Directives",[]).directive("width",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){e.css({width:n.width})}}}]).directive("height",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){e.css({height:n.height})}}}]).directive("minWidth",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){e.css({minWidth:n.minWidth})}}}]).directive("minHeight",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){e.css({minHeight:n.minHeight})}}}]).directive("elementLeave",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){var o=!1,i=function(r){r.target===e[0]||$(r.target).closest(e).length>0||(t.$apply(function(){t.$eval(n.elementLeave,{$event:r})}),o=!1,$(document).unbind("click",i))},r=function(){o=!0,$(document).click(i)};e.click(r),t.$on("$destroy",function(){$(document).unbind("click",i),e.unbind("click",r)})}}}]),angular.module("DockControl").controller("DockCtrl",["$scope","$orientation","$alignment",function(t,e,n){function o(e){linq(t.panels).where(function(t){return t.align!==e.align}).forEach(function(t){(!t.docked||t.docked&&t.index<e.index)&&(t[e.orientation]=e.docked?e.size:0)})}this.addPanel=function(e){t.panels.push(e)},this.panelDockedChanged=function(t){t.docked&&t.setToDefault(),o(t)},this.panelCollapseChanged=function(){},t.$orientation=e,t.panels=[],t.drag=function(i){var r=linq(t.panels).firstOrDefault(function(t){return t.dragging});if(r){switch(r.align){case n.horizontal:r.size=r.orientation===e.left?i.clientX-t.offset.left+5:$(i.currentTarget).width()-i.clientX-t.offset.left+5;break;case n.vertical:r.size=r.orientation===e.top?i.clientY-t.offset.left:$(i.currentTarget).height()-i.clientY-t.offset.left}linq(t.panels).forEach(function(t){o(t)})}},t.endDrag=function(){linq(t.panels).forEach(function(t){t.dragging=!1})}}]),angular.module("DockControl").controller("PanelCtrl",["$scope","$alignment","$orientation",function(t,e,n){function o(){return t.orientation===n.left||t.orientation===n.right?e.horizontal:t.orientation===n.top||t.orientation===n.bottom?e.vertical:e.middle}this.toggleDock=function(){t.toggleDock()},this.toggleCollapse=function(){t.toggleCollapse()},this.setHeader=function(e){t.header=e},this.hasHeader=function(){return""!==t.header},t.toggleDock=function(){t.docked=!t.docked},t.$align=e,t.$orientation=n,t.docked=!1,t.collapsed=!1,t.dragging=!1,t.header="",t.align=o(t.orientation),t.orientation===n.center&&(t.align=e.middle),t.startDrag=function(){t.dragging=!0},t.panelExpand=function(){t.collapsed=!1},t.panelLeave=function(){t.docked||(t.collapsed=!0)},t.setToDefault=function(){t.left="",t.right="",t.top="",t.bottom=""},t.setStyle=function(){return{width:t.align===e.horizontal?t.size:"",height:t.align===e.vertical?t.size:"",left:t.left,right:t.right,top:t.top,bottom:t.bottom}}}]),angular.module("DockControl").directive("panel",["DockControl.PathService",function(t){return{restrict:"AE",require:"^dock",replace:!0,transclude:!0,scope:{size:"=",minSize:"=",index:"@",orientation:"@"},templateUrl:t.templatesBaseUrl+"panel.tmpl.html",controller:"PanelCtrl",link:function(t,e,n,o){o.addPanel(t),t.$watch("docked",function(e){void 0!==e&&o.panelDockedChanged(t)}),t.docked="true"===n.docked?!0:!1,t.toggleCollapse=function(){t.collapsed=!t.collapsed,o.panelCollapseChanged(t)}}}}]).directive("header",["DockControl.PathService",function(t){return{restrict:"AE",replace:!0,transclude:!0,require:"^panel",templateUrl:t.templatesBaseUrl+"header.tmpl.html",link:function(t,e,n,o){t.docked=!1,t.toggleDock=function(){o.toggleDock(),t.docked=!t.docked},t.toggleCollapse=function(){o.toggleCollapse()},o.setHeader(e.text())}}}]).directive("content",["DockControl.PathService",function(t){return{restrict:"AE",replace:!0,transclude:!0,require:"^panel",templateUrl:t.templatesBaseUrl+"content.tmpl.html",link:function(t,e,n,o){t.hasHeader=o.hasHeader()}}}]);var scripts=document.getElementsByTagName("script"),currentScriptPath=scripts[scripts.length-1].src,dockControlRootPath=currentScriptPath.split("js/")[0];angular.module("DockControl").service("DockControl.PathService",[function(){return{templatesBaseUrl:dockControlRootPath+"templates/"}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRvY2tEaXJlY3RpdmUuanMiLCJhdHRyaWJ1dGVEaXJlY3RpdmVzLmpzIiwiZG9ja0N0cmwuanMiLCJwYW5lbEN0cmwuanMiLCJwYW5lbERpcmVjdGl2ZS5qcyIsInJlc291cmNlUGF0aFNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsUUFBQSxPQUFBLGVBQUEseUJBQ0EsU0FBQSxjQUNBLFdBQUEsYUFDQSxTQUFBLFdBQ0EsT0FBQSxXQUVBLFNBQUEsZ0JBQ0EsS0FBQSxPQUNBLE1BQUEsUUFDQSxJQUFBLE1BQ0EsT0FBQSxTQUNBLE9BQUEsV0FFQSxVQUFBLFFBQUEsMEJBQUEsU0FBQSxHQUNBLE9BQ0EsU0FBQSxLQUNBLFNBQUEsRUFDQSxZQUFBLEVBQ0EsWUFBQSxFQUFBLGlCQUFBLGlCQUNBLE9BQ0EsWUFBQSxLQUVBLFdBQUEsV0FDQSxLQUFBLFNBQUEsR0FHQSxRQUFBLEdBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxFQUFBLENBQ0EsR0FDQSxHQUFBLFdBQ0EsR0FBQSxFQUFBLFNBQUEsS0FBQSxFQUNBLEdBQUEsRUFBQSxTQUFBLE1BQUEsR0FFQSxFQUFBLEVBQUEsZUFDQSxFQUFBLE9BQUEsRUFFQSxRQUNBLElBQUEsRUFDQSxLQUFBLEdBZEEsRUFBQSxPQUFBLEVBQUEsRUFBQSwwQkN4QkEsUUFBQSxPQUFBLDJCQUNBLFVBQUEsU0FBQSxXQUNBLE9BQ0EsU0FBQSxJQUNBLFNBQUEsRUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLE1BQUEsRUFBQSxhQUlBLFVBQUEsVUFBQSxXQUNBLE9BQ0EsU0FBQSxJQUNBLFNBQUEsRUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLE9BQUEsRUFBQSxjQUlBLFVBQUEsWUFBQSxXQUNBLE9BQ0EsU0FBQSxJQUNBLFNBQUEsRUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLFNBQUEsRUFBQSxnQkFJQSxVQUFBLGFBQUEsV0FDQSxPQUNBLFNBQUEsSUFDQSxTQUFBLEVBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsS0FBQSxVQUFBLEVBQUEsaUJBSUEsVUFBQSxnQkFBQSxXQUNBLE9BQ0EsU0FBQSxJQUNBLFNBQUEsRUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsR0FBQSxJQUFBLEVBQ0EsRUFBQSxTQUFBLEdBQ0EsRUFBQSxTQUFBLEVBQUEsSUFBQSxFQUFBLEVBQUEsUUFBQSxRQUFBLEdBQUEsT0FBQSxJQUVBLEVBQUEsT0FBQSxXQUNBLEVBQUEsTUFBQSxFQUFBLGNBQUEsT0FBQSxNQUVBLEdBQUEsRUFDQSxFQUFBLFVBQUEsT0FBQSxRQUFBLEtBRUEsRUFBQSxXQUNBLEdBQUEsRUFDQSxFQUFBLFVBQUEsTUFBQSxHQUdBLEdBQUEsTUFBQSxHQUlBLEVBQUEsSUFBQSxXQUFBLFdBQ0EsRUFBQSxVQUFBLE9BQUEsUUFBQSxHQUNBLEVBQUEsT0FBQSxRQUFBLFVDL0RBLFFBQUEsT0FBQSxlQUNBLFdBQUEsWUFBQSxTQUFBLGVBQUEsYUFBQSxTQUFBLEVBQUEsRUFBQSxHQWtCQSxRQUFBLEdBQUEsR0FDQSxLQUFBLEVBQUEsUUFBQSxNQUFBLFNBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSxFQUFBLFFBQ0EsUUFBQSxTQUFBLEtBQ0EsRUFBQSxRQUFBLEVBQUEsUUFBQSxFQUFBLE1BQUEsRUFBQSxTQUNBLEVBQUEsRUFBQSxhQUFBLEVBQUEsT0FBQSxFQUFBLEtBQUEsS0F0QkEsS0FBQSxTQUFBLFNBQUEsR0FDQSxFQUFBLE9BQUEsS0FBQSxJQUVBLEtBQUEsbUJBQUEsU0FBQSxHQUNBLEVBQUEsUUFDQSxFQUFBLGVBRUEsRUFBQSxJQUVBLEtBQUEscUJBQUEsYUFrQkEsRUFBQSxhQUFBLEVBQ0EsRUFBQSxVQUNBLEVBQUEsS0FBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEtBQUEsRUFBQSxRQUFBLGVBQUEsU0FBQSxHQUNBLE1BQUEsR0FBQSxVQUVBLElBQUEsRUFBQSxDQUdBLE9BQUEsRUFBQSxPQUNBLElBQUEsR0FBQSxXQUNBLEVBQUEsS0FBQSxFQUFBLGNBQUEsRUFBQSxLQUFBLEVBQUEsUUFBQSxFQUFBLE9BQUEsS0FBQSxFQUFBLEVBQUEsRUFBQSxlQUFBLFFBQUEsRUFBQSxRQUFBLEVBQUEsT0FBQSxLQUFBLENBQ0EsTUFDQSxLQUFBLEdBQUEsU0FDQSxFQUFBLEtBQUEsRUFBQSxjQUFBLEVBQUEsSUFBQSxFQUFBLFFBQUEsRUFBQSxPQUFBLEtBQUEsRUFBQSxFQUFBLGVBQUEsU0FBQSxFQUFBLFFBQUEsRUFBQSxPQUFBLEtBR0EsS0FBQSxFQUFBLFFBQ0EsUUFBQSxTQUFBLEdBQ0EsRUFBQSxPQUlBLEVBQUEsUUFBQSxXQUNBLEtBQUEsRUFBQSxRQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsVUFBQSxRQ3REQSxRQUFBLE9BQUEsZUFDQSxXQUFBLGFBQUEsU0FBQSxhQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsR0FrQkEsUUFBQSxLQUNBLE1BQUEsR0FBQSxjQUFBLEVBQUEsTUFBQSxFQUFBLGNBQUEsRUFBQSxNQUNBLEVBQUEsV0FFQSxFQUFBLGNBQUEsRUFBQSxLQUFBLEVBQUEsY0FBQSxFQUFBLE9BQ0EsRUFBQSxTQUVBLEVBQUEsT0F2QkEsS0FBQSxXQUFBLFdBQ0EsRUFBQSxjQUdBLEtBQUEsZUFBQSxXQUNBLEVBQUEsa0JBR0EsS0FBQSxVQUFBLFNBQUEsR0FDQSxFQUFBLE9BQUEsR0FHQSxLQUFBLFVBQUEsV0FDQSxNQUFBLEtBQUEsRUFBQSxRQWFBLEVBQUEsV0FBQSxXQUNBLEVBQUEsUUFBQSxFQUFBLFFBR0EsRUFBQSxPQUFBLEVBQ0EsRUFBQSxhQUFBLEVBQ0EsRUFBQSxRQUFBLEVBQ0EsRUFBQSxXQUFBLEVBQ0EsRUFBQSxVQUFBLEVBQ0EsRUFBQSxPQUFBLEdBQ0EsRUFBQSxNQUFBLEVBQUEsRUFBQSxhQUNBLEVBQUEsY0FBQSxFQUFBLFNBQ0EsRUFBQSxNQUFBLEVBQUEsUUFHQSxFQUFBLFVBQUEsV0FDQSxFQUFBLFVBQUEsR0FHQSxFQUFBLFlBQUEsV0FDQSxFQUFBLFdBQUEsR0FHQSxFQUFBLFdBQUEsV0FDQSxFQUFBLFNBQ0EsRUFBQSxXQUFBLElBSUEsRUFBQSxhQUFBLFdBQ0EsRUFBQSxLQUFBLEdBQ0EsRUFBQSxNQUFBLEdBQ0EsRUFBQSxJQUFBLEdBQ0EsRUFBQSxPQUFBLElBR0EsRUFBQSxTQUFBLFdBQ0EsT0FDQSxNQUFBLEVBQUEsUUFBQSxFQUFBLFdBQUEsRUFBQSxLQUFBLEdBQ0EsT0FBQSxFQUFBLFFBQUEsRUFBQSxTQUFBLEVBQUEsS0FBQSxHQUNBLEtBQUEsRUFBQSxLQUNBLE1BQUEsRUFBQSxNQUNBLElBQUEsRUFBQSxJQUNBLE9BQUEsRUFBQSxZQ3hFQSxRQUFBLE9BQUEsZUFDQSxVQUFBLFNBQUEsMEJBQUEsU0FBQSxHQUNBLE9BQ0EsU0FBQSxLQUNBLFFBQUEsUUFDQSxTQUFBLEVBQ0EsWUFBQSxFQUNBLE9BQ0EsS0FBQSxJQUNBLFFBQUEsSUFDQSxNQUFBLElBQ0EsWUFBQSxLQUVBLFlBQUEsRUFBQSxpQkFBQSxrQkFDQSxXQUFBLFlBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBS0EsRUFBQSxTQUFBLEdBRUEsRUFBQSxPQUFBLFNBQUEsU0FBQSxHQUVBLFNBQUEsR0FDQSxFQUFBLG1CQUFBLEtBSUEsRUFBQSxPQUFBLFNBQUEsRUFBQSxRQUFBLEdBQUEsRUFFQSxFQUFBLGVBQUEsV0FDQSxFQUFBLFdBQUEsRUFBQSxVQUNBLEVBQUEscUJBQUEsU0FLQSxVQUFBLFVBQUEsMEJBQUEsU0FBQSxHQUNBLE9BQ0EsU0FBQSxLQUNBLFNBQUEsRUFDQSxZQUFBLEVBQ0EsUUFBQSxTQUNBLFlBQUEsRUFBQSxpQkFBQSxtQkFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLFFBQUEsRUFDQSxFQUFBLFdBQUEsV0FDQSxFQUFBLGFBQ0EsRUFBQSxRQUFBLEVBQUEsUUFFQSxFQUFBLGVBQUEsV0FDQSxFQUFBLGtCQUVBLEVBQUEsVUFBQSxFQUFBLGFBSUEsVUFBQSxXQUFBLDBCQUFBLFNBQUEsR0FDQSxPQUNBLFNBQUEsS0FDQSxTQUFBLEVBQ0EsWUFBQSxFQUNBLFFBQUEsU0FDQSxZQUFBLEVBQUEsaUJBQUEsb0JBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxVQUFBLEVBQUEsZ0JDbEVBLElBQUEsU0FBQSxTQUFBLHFCQUFBLFVBQ0Esa0JBQUEsUUFBQSxRQUFBLE9BQUEsR0FBQSxJQUNBLG9CQUFBLGtCQUFBLE1BQUEsT0FBQSxFQUVBLFNBQUEsT0FBQSxlQUNBLFFBQUEsMkJBQUEsV0FDQSxPQUNBLGlCQUFBLG9CQUFBIiwiZmlsZSI6ImRvY2tDb250cm9sLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGdtZXN6YXJvcyBvbiA4LzUvMjAxNC5cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdEb2NrQ29udHJvbCcsIFsnQXR0cmlidXRlLkRpcmVjdGl2ZXMnXSlcclxuICAgIC5jb25zdGFudCgnJGFsaWdubWVudCcsIHtcclxuICAgICAgICBob3Jpem9udGFsOiBcImhvcml6b250YWxcIixcclxuICAgICAgICB2ZXJ0aWNhbDogXCJ2ZXJ0aWNhbFwiLFxyXG4gICAgICAgIG1pZGRsZTogXCJtaWRkbGVcIlxyXG4gICAgfSlcclxuICAgIC5jb25zdGFudCgnJG9yaWVudGF0aW9uJywge1xyXG4gICAgICAgIGxlZnQ6IFwibGVmdFwiLFxyXG4gICAgICAgIHJpZ2h0OiBcInJpZ2h0XCIsXHJcbiAgICAgICAgdG9wOiBcInRvcFwiLFxyXG4gICAgICAgIGJvdHRvbTogXCJib3R0b21cIixcclxuICAgICAgICBjZW50ZXI6IFwiY2VudGVyXCJcclxuICAgIH0pXHJcbiAgICAuZGlyZWN0aXZlKCdkb2NrJywgW1wiRG9ja0NvbnRyb2wuUGF0aFNlcnZpY2VcIiwgZnVuY3Rpb24gKCRwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBRScsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAkcGF0aC50ZW1wbGF0ZXNCYXNlVXJsICsgJ2RvY2sudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgc2NvcGU6IHtcclxuICAgICAgICAgICAgICAgIHNpemVDaGFuZ2VkOiAnPSdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0RvY2tDdHJsJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5vZmZzZXQgPSBfYWJzb2x1dGVPZmZzZXQoJCgnLnBhbmVsLWNvbnRhaW5lcicpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBfYWJzb2x1dGVPZmZzZXQoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSAwLCBsZWZ0ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Lm9mZnNldCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3AgKz0gZWxlbWVudC5vZmZzZXQoKS50b3AgfHwgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQgKz0gZWxlbWVudC5vZmZzZXQoKS5sZWZ0IHx8IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSB3aGlsZSAoZWxlbWVudC5sZW5ndGggPiAwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiB0b3AsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGxlZnRcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBnbWVzemFyb3Mgb24gOS81LzIwMTQuXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnQXR0cmlidXRlLkRpcmVjdGl2ZXMnLCBbXSlcclxuICAgIC5kaXJlY3RpdmUoJ3dpZHRoJywgW2Z1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyh7d2lkdGg6IGF0dHJzLndpZHRofSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pXHJcbiAgICAuZGlyZWN0aXZlKCdoZWlnaHQnLCBbZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKHtoZWlnaHQ6IGF0dHJzLmhlaWdodH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWluV2lkdGgnLCBbZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKHttaW5XaWR0aDogYXR0cnMubWluV2lkdGh9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSlcclxuICAgIC5kaXJlY3RpdmUoJ21pbkhlaWdodCcsIFtmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5jc3Moe21pbkhlaWdodDogYXR0cnMubWluSGVpZ2h0fSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pXHJcbiAgICAuZGlyZWN0aXZlKCdlbGVtZW50TGVhdmUnLCBbZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uICgkc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9tQ2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZXZlbnQudGFyZ2V0ID09PSBlbGVtZW50WzBdIHx8ICQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KGVsZW1lbnQpLmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRldmFsKGF0dHJzLmVsZW1lbnRMZWF2ZSwgeyAkZXZlbnQ6IGV2ZW50IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLnVuYmluZCgnY2xpY2snLCBkb21DbGlja0hhbmRsZXIpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50Q2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKCRldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudCkuY2xpY2soZG9tQ2xpY2tIYW5kbGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsaWNrKGVsZW1lbnRDbGlja0hhbmRsZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvL0Rpc3Bvc2luZ1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudCkudW5iaW5kKCdjbGljaycsIGRvbUNsaWNrSGFuZGxlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC51bmJpbmQoJ2NsaWNrJywgZWxlbWVudENsaWNrSGFuZGxlcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgZ21lc3phcm9zIG9uIDgvNS8yMDE0LlxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ0RvY2tDb250cm9sJylcclxuICAgIC5jb250cm9sbGVyKCdEb2NrQ3RybCcsIFsnJHNjb3BlJywgJyRvcmllbnRhdGlvbicsICckYWxpZ25tZW50JywgZnVuY3Rpb24gKCRzY29wZSwgJG9yaWVudGF0aW9uLCAkYWxpZ24pIHtcclxuICAgICAgICB0aGlzLmFkZFBhbmVsID0gZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wYW5lbHMucHVzaChwYW5lbCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhbmVsRG9ja2VkQ2hhbmdlZCA9IGZ1bmN0aW9uIChwYW5lbCkge1xyXG4gICAgICAgICAgICBpZiAocGFuZWwuZG9ja2VkKSB7XHJcbiAgICAgICAgICAgICAgICBwYW5lbC5zZXRUb0RlZmF1bHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBfc2V0U2l6ZShwYW5lbCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhbmVsQ29sbGFwc2VDaGFuZ2VkID0gZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgICAgIC8qbGlucSgkc2NvcGUucGFuZWxzKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbSAhPT0gcGFuZWwgJiYgaXRlbS5vcmllbnRhdGlvbiA9PT0gcGFuZWwub3JpZW50YXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNvbGxhcHNlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pOyovXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX3NldFNpemUocmVmUGFuZWwpIHtcclxuICAgICAgICAgICAgbGlucSgkc2NvcGUucGFuZWxzKS53aGVyZShmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uYWxpZ24gIT09IHJlZlBhbmVsLmFsaWduO1xyXG4gICAgICAgICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChwYW5lbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwYW5lbC5kb2NrZWQgfHwgKHBhbmVsLmRvY2tlZCAmJiBwYW5lbC5pbmRleCA8IHJlZlBhbmVsLmluZGV4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhbmVsW3JlZlBhbmVsLm9yaWVudGF0aW9uXSA9IHJlZlBhbmVsLmRvY2tlZCA/IHJlZlBhbmVsLnNpemUgOiAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb3JpZW50YXRpb24gPSAkb3JpZW50YXRpb247XHJcbiAgICAgICAgJHNjb3BlLnBhbmVscyA9IFtdO1xyXG4gICAgICAgICRzY29wZS5kcmFnID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwYW5lbCA9IGxpbnEoJHNjb3BlLnBhbmVscykuZmlyc3RPckRlZmF1bHQoZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmRyYWdnaW5nO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKCFwYW5lbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN3aXRjaCAocGFuZWwuYWxpZ24pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJGFsaWduLmhvcml6b250YWw6XHJcbiAgICAgICAgICAgICAgICAgICAgcGFuZWwuc2l6ZSA9IHBhbmVsLm9yaWVudGF0aW9uID09PSAkb3JpZW50YXRpb24ubGVmdCA/IGV2ZW50LmNsaWVudFggLSAkc2NvcGUub2Zmc2V0LmxlZnQgKyA1IDogJChldmVudC5jdXJyZW50VGFyZ2V0KS53aWR0aCgpIC0gZXZlbnQuY2xpZW50WCAtICRzY29wZS5vZmZzZXQubGVmdCArIDU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICRhbGlnbi52ZXJ0aWNhbDpcclxuICAgICAgICAgICAgICAgICAgICBwYW5lbC5zaXplID0gcGFuZWwub3JpZW50YXRpb24gPT09ICRvcmllbnRhdGlvbi50b3AgPyBldmVudC5jbGllbnRZIC0gJHNjb3BlLm9mZnNldC5sZWZ0IDogJChldmVudC5jdXJyZW50VGFyZ2V0KS5oZWlnaHQoKSAtIGV2ZW50LmNsaWVudFkgLSAkc2NvcGUub2Zmc2V0LmxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGlucSgkc2NvcGUucGFuZWxzKVxyXG4gICAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBfc2V0U2l6ZShpdGVtKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5lbmREcmFnID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsaW5xKCRzY29wZS5wYW5lbHMpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uZHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1dKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBnbWVzemFyb3Mgb24gOC81LzIwMTQuXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnRG9ja0NvbnRyb2wnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1BhbmVsQ3RybCcsIFsnJHNjb3BlJywgJyRhbGlnbm1lbnQnLCAnJG9yaWVudGF0aW9uJywgZnVuY3Rpb24gKCRzY29wZSwgJGFsaWduLCAkb3JpZW50YXRpb24pIHtcclxuXHJcbiAgICAgICAgdGhpcy50b2dnbGVEb2NrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlRG9jaygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMudG9nZ2xlQ29sbGFwc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVDb2xsYXBzZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuc2V0SGVhZGVyID0gZnVuY3Rpb24gKGhlYWRlcikge1xyXG4gICAgICAgICAgICAkc2NvcGUuaGVhZGVyID0gaGVhZGVyO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuaGFzSGVhZGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmhlYWRlciAhPT0gXCJcIjtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRBbGlnbihvcmllbnRhdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLm9yaWVudGF0aW9uID09PSAkb3JpZW50YXRpb24ubGVmdCB8fCAkc2NvcGUub3JpZW50YXRpb24gPT09ICRvcmllbnRhdGlvbi5yaWdodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRhbGlnbi5ob3Jpem9udGFsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUub3JpZW50YXRpb24gPT09ICRvcmllbnRhdGlvbi50b3AgfHwgJHNjb3BlLm9yaWVudGF0aW9uID09PSAkb3JpZW50YXRpb24uYm90dG9tKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJGFsaWduLnZlcnRpY2FsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAkYWxpZ24ubWlkZGxlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLnRvZ2dsZURvY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5kb2NrZWQgPSAhJHNjb3BlLmRvY2tlZDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuJGFsaWduID0gJGFsaWduO1xyXG4gICAgICAgICRzY29wZS4kb3JpZW50YXRpb24gPSAkb3JpZW50YXRpb247XHJcbiAgICAgICAgJHNjb3BlLmRvY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5jb2xsYXBzZWQgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuZHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuaGVhZGVyID0gXCJcIjtcclxuICAgICAgICAkc2NvcGUuYWxpZ24gPSBnZXRBbGlnbigkc2NvcGUub3JpZW50YXRpb24pO1xyXG4gICAgICAgIGlmICgkc2NvcGUub3JpZW50YXRpb24gPT09ICRvcmllbnRhdGlvbi5jZW50ZXIpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmFsaWduID0gJGFsaWduLm1pZGRsZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5zdGFydERyYWcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5kcmFnZ2luZyA9IHRydWU7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnBhbmVsRXhwYW5kID0gZnVuY3Rpb24gKCRldmVudCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY29sbGFwc2VkID0gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnBhbmVsTGVhdmUgPSBmdW5jdGlvbiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmICghJHNjb3BlLmRvY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbGxhcHNlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuc2V0VG9EZWZhdWx0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUubGVmdCA9ICcnO1xyXG4gICAgICAgICAgICAkc2NvcGUucmlnaHQgPSAnJztcclxuICAgICAgICAgICAgJHNjb3BlLnRvcCA9ICcnO1xyXG4gICAgICAgICAgICAkc2NvcGUuYm90dG9tID0gJyc7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnNldFN0eWxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6ICRzY29wZS5hbGlnbiA9PT0gJGFsaWduLmhvcml6b250YWwgPyAkc2NvcGUuc2l6ZSA6ICcnLFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAkc2NvcGUuYWxpZ24gPT09ICRhbGlnbi52ZXJ0aWNhbCA/ICRzY29wZS5zaXplIDogJycsXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiAkc2NvcGUubGVmdCxcclxuICAgICAgICAgICAgICAgIHJpZ2h0OiAkc2NvcGUucmlnaHQsXHJcbiAgICAgICAgICAgICAgICB0b3A6ICRzY29wZS50b3AsXHJcbiAgICAgICAgICAgICAgICBib3R0b206ICRzY29wZS5ib3R0b21cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgfV0pOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGdtZXN6YXJvcyBvbiA4LzUvMjAxNC5cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdEb2NrQ29udHJvbCcpXHJcbiAgICAuZGlyZWN0aXZlKCdwYW5lbCcsIFtcIkRvY2tDb250cm9sLlBhdGhTZXJ2aWNlXCIsIGZ1bmN0aW9uICgkcGF0aCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQUUnLFxyXG4gICAgICAgICAgICByZXF1aXJlOiAnXmRvY2snLFxyXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICAgICAgc2l6ZTogJz0nLFxyXG4gICAgICAgICAgICAgICAgbWluU2l6ZTogJz0nLFxyXG4gICAgICAgICAgICAgICAgaW5kZXg6ICdAJyxcclxuICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uOiAnQCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICRwYXRoLnRlbXBsYXRlc0Jhc2VVcmwgKyAncGFuZWwudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1BhbmVsQ3RybCcsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uICgkc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBkb2NrQ3RybCkge1xyXG4gICAgICAgICAgICAgICAgLy8kc2NvcGUuc2l6ZSA9IHBhcnNlRmxvYXQoJHNjb3BlLnNpemUpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvL0FkZCBwYW5lbCB0byB0aGUgZG9ja1xyXG4gICAgICAgICAgICAgICAgZG9ja0N0cmwuYWRkUGFuZWwoJHNjb3BlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCdkb2NrZWQnLCBmdW5jdGlvbiAodmFsdWUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9ja0N0cmwucGFuZWxEb2NrZWRDaGFuZ2VkKCRzY29wZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRvY2tlZCA9IGF0dHJzLmRvY2tlZCA9PT0gXCJ0cnVlXCIgPyB0cnVlIDogZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUNvbGxhcHNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jb2xsYXBzZWQgPSAhJHNjb3BlLmNvbGxhcHNlZDtcclxuICAgICAgICAgICAgICAgICAgICBkb2NrQ3RybC5wYW5lbENvbGxhcHNlQ2hhbmdlZCgkc2NvcGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSlcclxuICAgIC5kaXJlY3RpdmUoJ2hlYWRlcicsIFtcIkRvY2tDb250cm9sLlBhdGhTZXJ2aWNlXCIsIGZ1bmN0aW9uICgkcGF0aCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQUUnLFxyXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgICAgICAgICByZXF1aXJlOiAnXnBhbmVsJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICRwYXRoLnRlbXBsYXRlc0Jhc2VVcmwgKyAnaGVhZGVyLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uICgkc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBwYW5lbEN0cmwpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kb2NrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS50b2dnbGVEb2NrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhbmVsQ3RybC50b2dnbGVEb2NrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRvY2tlZCA9ICEkc2NvcGUuZG9ja2VkO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICRzY29wZS50b2dnbGVDb2xsYXBzZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYW5lbEN0cmwudG9nZ2xlQ29sbGFwc2UoKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBwYW5lbEN0cmwuc2V0SGVhZGVyKGVsZW1lbnQudGV4dCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSlcclxuICAgIC5kaXJlY3RpdmUoJ2NvbnRlbnQnLCBbXCJEb2NrQ29udHJvbC5QYXRoU2VydmljZVwiLCBmdW5jdGlvbiAoJHBhdGgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0FFJyxcclxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgICAgICAgICAgcmVxdWlyZTogJ15wYW5lbCcsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAkcGF0aC50ZW1wbGF0ZXNCYXNlVXJsICsgJ2NvbnRlbnQudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgcGFuZWxDdHJsKSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZS5oYXNIZWFkZXIgPSBwYW5lbEN0cmwuaGFzSGVhZGVyKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGdtZXN6YXJvcyBvbiAxMC82LzIwMTQuXHJcbiAqL1xyXG52YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xyXG52YXIgY3VycmVudFNjcmlwdFBhdGggPSBzY3JpcHRzW3NjcmlwdHMubGVuZ3RoIC0gMV0uc3JjO1xyXG52YXIgZG9ja0NvbnRyb2xSb290UGF0aCA9IGN1cnJlbnRTY3JpcHRQYXRoLnNwbGl0KFwianMvXCIpWzBdO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0RvY2tDb250cm9sJylcclxuICAgIC5zZXJ2aWNlKFwiRG9ja0NvbnRyb2wuUGF0aFNlcnZpY2VcIiwgWyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJue1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZXNCYXNlVXJsOiBkb2NrQ29udHJvbFJvb3RQYXRoICsgXCJ0ZW1wbGF0ZXMvXCJcclxuICAgICAgICB9O1xyXG4gICAgfV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==