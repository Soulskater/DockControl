angular.module("DockControl",["Attribute.Directives"]).constant("$alignment",{horizontal:"horizontal",vertical:"vertical",middle:"middle"}).constant("$orientation",{left:"left",right:"right",top:"top",bottom:"bottom",center:"center"}).directive("dock",["DockControl.PathService",function(t){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:t.templatesBaseUrl+"dock.tmpl.html",scope:{sizeChanged:"="},controller:"DockCtrl",link:function(t){function e(t){var e=0,n=0;do t.offset()&&(e+=t.offset().top||0,n+=t.offset().left||0),t=t.parent();while(t.length>0);return{top:e,left:n}}t.offset=e($(".panel-container"))}}}]),angular.module("Attribute.Directives",[]).directive("width",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){e.css({width:n.width})}}}]).directive("height",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){e.css({height:n.height})}}}]).directive("minWidth",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){e.css({minWidth:n.minWidth})}}}]).directive("minHeight",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){e.css({minHeight:n.minHeight})}}}]).directive("elementLeave",[function(){return{restrict:"A",replace:!0,link:function(t,e,n){var o=!1,i=function(r){r.target===e[0]||$(r.target).closest(e).length>0||(t.$apply(function(){t.$eval(n.elementLeave,{$event:r})}),o=!1,$(document).unbind("click",i))},r=function(){o=!0,$(document).click(i)};e.click(r),t.$on("$destroy",function(){$(document).unbind("click",i),e.unbind("click",r)})}}}]),angular.module("DockControl").controller("DockCtrl",["$scope","$orientation","$alignment",function(t,e,n){function o(e){linq(t.panels).where(function(t){return t.align!==e.align}).forEach(function(t){(!t.docked||t.docked&&t.index<e.index)&&(t[e.orientation]=e.docked?e.size:0)}),t.sizeChanged=!t.sizeChanged}this.addPanel=function(e){t.panels.push(e)},this.panelDockedChanged=function(t){t.docked&&t.setToDefault(),o(t)},this.panelCollapseChanged=function(){},t.$orientation=e,t.panels=[],t.drag=function(i){var r=linq(t.panels).firstOrDefault(function(t){return t.dragging});if(r){switch(r.align){case n.horizontal:r.size=r.orientation===e.left?i.clientX-t.offset.left+5:$(i.currentTarget).width()-i.clientX-t.offset.left+5;break;case n.vertical:r.size=r.orientation===e.top?i.clientY-t.offset.left:$(i.currentTarget).height()-i.clientY-t.offset.left}linq(t.panels).forEach(function(t){o(t)})}},t.endDrag=function(){linq(t.panels).forEach(function(t){t.dragging=!1})}}]),angular.module("DockControl").controller("PanelCtrl",["$scope","$alignment","$orientation",function(t,e,n){function o(){return t.orientation===n.left||t.orientation===n.right?e.horizontal:t.orientation===n.top||t.orientation===n.bottom?e.vertical:e.middle}this.toggleDock=function(){t.toggleDock()},this.toggleCollapse=function(){t.toggleCollapse()},this.setHeader=function(e){t.header=e},this.hasHeader=function(){return""!==t.header},t.toggleDock=function(){t.docked=!t.docked},t.$align=e,t.$orientation=n,t.docked=!1,t.collapsed=!1,t.dragging=!1,t.header="",t.align=o(t.orientation),t.orientation===n.center&&(t.align=e.middle),t.startDrag=function(){t.dragging=!0},t.panelExpand=function(){t.collapsed=!1},t.panelLeave=function(){t.docked||(t.collapsed=!0)},t.setToDefault=function(){t.left="",t.right="",t.top="",t.bottom=""},t.setStyle=function(){return{width:t.align===e.horizontal?t.size:"",height:t.align===e.vertical?t.size:"",left:t.left,right:t.right,top:t.top,bottom:t.bottom}}}]),angular.module("DockControl").directive("panel",["DockControl.PathService",function(t){return{restrict:"AE",require:"^dock",replace:!0,transclude:!0,scope:{size:"=",minSize:"=",index:"@",orientation:"@"},templateUrl:t.templatesBaseUrl+"panel.tmpl.html",controller:"PanelCtrl",link:function(t,e,n,o){o.addPanel(t),t.$watch("docked",function(e){void 0!==e&&o.panelDockedChanged(t)}),t.docked="true"===n.docked?!0:!1,t.toggleCollapse=function(){t.collapsed=!t.collapsed,o.panelCollapseChanged(t)}}}}]).directive("header",["DockControl.PathService",function(t){return{restrict:"AE",replace:!0,transclude:!0,require:"^panel",templateUrl:t.templatesBaseUrl+"header.tmpl.html",link:function(t,e,n,o){t.docked=!1,t.toggleDock=function(){o.toggleDock(),t.docked=!t.docked},t.toggleCollapse=function(){o.toggleCollapse()},o.setHeader(e.text())}}}]).directive("content",["DockControl.PathService",function(t){return{restrict:"AE",replace:!0,transclude:!0,require:"^panel",templateUrl:t.templatesBaseUrl+"content.tmpl.html",link:function(t,e,n,o){t.hasHeader=o.hasHeader()}}}]);var scripts=document.getElementsByTagName("script"),currentScriptPath=scripts[scripts.length-1].src,dockControlRootPath=currentScriptPath.split("js/")[0];angular.module("DockControl").service("DockControl.PathService",[function(){return{templatesBaseUrl:dockControlRootPath+"templates/"}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRvY2tEaXJlY3RpdmUuanMiLCJhdHRyaWJ1dGVEaXJlY3RpdmVzLmpzIiwiZG9ja0N0cmwuanMiLCJwYW5lbEN0cmwuanMiLCJwYW5lbERpcmVjdGl2ZS5qcyIsInJlc291cmNlUGF0aFNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsUUFBQSxPQUFBLGVBQUEseUJBQ0EsU0FBQSxjQUNBLFdBQUEsYUFDQSxTQUFBLFdBQ0EsT0FBQSxXQUVBLFNBQUEsZ0JBQ0EsS0FBQSxPQUNBLE1BQUEsUUFDQSxJQUFBLE1BQ0EsT0FBQSxTQUNBLE9BQUEsV0FFQSxVQUFBLFFBQUEsMEJBQUEsU0FBQSxHQUNBLE9BQ0EsU0FBQSxLQUNBLFNBQUEsRUFDQSxZQUFBLEVBQ0EsWUFBQSxFQUFBLGlCQUFBLGlCQUNBLE9BQ0EsWUFBQSxLQUVBLFdBQUEsV0FDQSxLQUFBLFNBQUEsR0FHQSxRQUFBLEdBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxFQUFBLENBQ0EsR0FDQSxHQUFBLFdBQ0EsR0FBQSxFQUFBLFNBQUEsS0FBQSxFQUNBLEdBQUEsRUFBQSxTQUFBLE1BQUEsR0FFQSxFQUFBLEVBQUEsZUFDQSxFQUFBLE9BQUEsRUFFQSxRQUNBLElBQUEsRUFDQSxLQUFBLEdBZEEsRUFBQSxPQUFBLEVBQUEsRUFBQSwwQkN4QkEsUUFBQSxPQUFBLDJCQUNBLFVBQUEsU0FBQSxXQUNBLE9BQ0EsU0FBQSxJQUNBLFNBQUEsRUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLE1BQUEsRUFBQSxhQUlBLFVBQUEsVUFBQSxXQUNBLE9BQ0EsU0FBQSxJQUNBLFNBQUEsRUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLE9BQUEsRUFBQSxjQUlBLFVBQUEsWUFBQSxXQUNBLE9BQ0EsU0FBQSxJQUNBLFNBQUEsRUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLFNBQUEsRUFBQSxnQkFJQSxVQUFBLGFBQUEsV0FDQSxPQUNBLFNBQUEsSUFDQSxTQUFBLEVBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsS0FBQSxVQUFBLEVBQUEsaUJBSUEsVUFBQSxnQkFBQSxXQUNBLE9BQ0EsU0FBQSxJQUNBLFNBQUEsRUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsR0FBQSxJQUFBLEVBQ0EsRUFBQSxTQUFBLEdBQ0EsRUFBQSxTQUFBLEVBQUEsSUFBQSxFQUFBLEVBQUEsUUFBQSxRQUFBLEdBQUEsT0FBQSxJQUVBLEVBQUEsT0FBQSxXQUNBLEVBQUEsTUFBQSxFQUFBLGNBQUEsT0FBQSxNQUVBLEdBQUEsRUFDQSxFQUFBLFVBQUEsT0FBQSxRQUFBLEtBRUEsRUFBQSxXQUNBLEdBQUEsRUFDQSxFQUFBLFVBQUEsTUFBQSxHQUdBLEdBQUEsTUFBQSxHQUlBLEVBQUEsSUFBQSxXQUFBLFdBQ0EsRUFBQSxVQUFBLE9BQUEsUUFBQSxHQUNBLEVBQUEsT0FBQSxRQUFBLFVDL0RBLFFBQUEsT0FBQSxlQUNBLFdBQUEsWUFBQSxTQUFBLGVBQUEsYUFBQSxTQUFBLEVBQUEsRUFBQSxHQWtCQSxRQUFBLEdBQUEsR0FDQSxLQUFBLEVBQUEsUUFBQSxNQUFBLFNBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSxFQUFBLFFBQ0EsUUFBQSxTQUFBLEtBQ0EsRUFBQSxRQUFBLEVBQUEsUUFBQSxFQUFBLE1BQUEsRUFBQSxTQUNBLEVBQUEsRUFBQSxhQUFBLEVBQUEsT0FBQSxFQUFBLEtBQUEsS0FHQSxFQUFBLGFBQUEsRUFBQSxZQXpCQSxLQUFBLFNBQUEsU0FBQSxHQUNBLEVBQUEsT0FBQSxLQUFBLElBRUEsS0FBQSxtQkFBQSxTQUFBLEdBQ0EsRUFBQSxRQUNBLEVBQUEsZUFFQSxFQUFBLElBRUEsS0FBQSxxQkFBQSxhQW1CQSxFQUFBLGFBQUEsRUFDQSxFQUFBLFVBQ0EsRUFBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsS0FBQSxFQUFBLFFBQUEsZUFBQSxTQUFBLEdBQ0EsTUFBQSxHQUFBLFVBRUEsSUFBQSxFQUFBLENBR0EsT0FBQSxFQUFBLE9BQ0EsSUFBQSxHQUFBLFdBQ0EsRUFBQSxLQUFBLEVBQUEsY0FBQSxFQUFBLEtBQUEsRUFBQSxRQUFBLEVBQUEsT0FBQSxLQUFBLEVBQUEsRUFBQSxFQUFBLGVBQUEsUUFBQSxFQUFBLFFBQUEsRUFBQSxPQUFBLEtBQUEsQ0FDQSxNQUNBLEtBQUEsR0FBQSxTQUNBLEVBQUEsS0FBQSxFQUFBLGNBQUEsRUFBQSxJQUFBLEVBQUEsUUFBQSxFQUFBLE9BQUEsS0FBQSxFQUFBLEVBQUEsZUFBQSxTQUFBLEVBQUEsUUFBQSxFQUFBLE9BQUEsS0FHQSxLQUFBLEVBQUEsUUFDQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE9BSUEsRUFBQSxRQUFBLFdBQ0EsS0FBQSxFQUFBLFFBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxVQUFBLFFDdkRBLFFBQUEsT0FBQSxlQUNBLFdBQUEsYUFBQSxTQUFBLGFBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQWtCQSxRQUFBLEtBQ0EsTUFBQSxHQUFBLGNBQUEsRUFBQSxNQUFBLEVBQUEsY0FBQSxFQUFBLE1BQ0EsRUFBQSxXQUVBLEVBQUEsY0FBQSxFQUFBLEtBQUEsRUFBQSxjQUFBLEVBQUEsT0FDQSxFQUFBLFNBRUEsRUFBQSxPQXZCQSxLQUFBLFdBQUEsV0FDQSxFQUFBLGNBR0EsS0FBQSxlQUFBLFdBQ0EsRUFBQSxrQkFHQSxLQUFBLFVBQUEsU0FBQSxHQUNBLEVBQUEsT0FBQSxHQUdBLEtBQUEsVUFBQSxXQUNBLE1BQUEsS0FBQSxFQUFBLFFBYUEsRUFBQSxXQUFBLFdBQ0EsRUFBQSxRQUFBLEVBQUEsUUFHQSxFQUFBLE9BQUEsRUFDQSxFQUFBLGFBQUEsRUFDQSxFQUFBLFFBQUEsRUFDQSxFQUFBLFdBQUEsRUFDQSxFQUFBLFVBQUEsRUFDQSxFQUFBLE9BQUEsR0FDQSxFQUFBLE1BQUEsRUFBQSxFQUFBLGFBQ0EsRUFBQSxjQUFBLEVBQUEsU0FDQSxFQUFBLE1BQUEsRUFBQSxRQUdBLEVBQUEsVUFBQSxXQUNBLEVBQUEsVUFBQSxHQUdBLEVBQUEsWUFBQSxXQUNBLEVBQUEsV0FBQSxHQUdBLEVBQUEsV0FBQSxXQUNBLEVBQUEsU0FDQSxFQUFBLFdBQUEsSUFJQSxFQUFBLGFBQUEsV0FDQSxFQUFBLEtBQUEsR0FDQSxFQUFBLE1BQUEsR0FDQSxFQUFBLElBQUEsR0FDQSxFQUFBLE9BQUEsSUFHQSxFQUFBLFNBQUEsV0FDQSxPQUNBLE1BQUEsRUFBQSxRQUFBLEVBQUEsV0FBQSxFQUFBLEtBQUEsR0FDQSxPQUFBLEVBQUEsUUFBQSxFQUFBLFNBQUEsRUFBQSxLQUFBLEdBQ0EsS0FBQSxFQUFBLEtBQ0EsTUFBQSxFQUFBLE1BQ0EsSUFBQSxFQUFBLElBQ0EsT0FBQSxFQUFBLFlDeEVBLFFBQUEsT0FBQSxlQUNBLFVBQUEsU0FBQSwwQkFBQSxTQUFBLEdBQ0EsT0FDQSxTQUFBLEtBQ0EsUUFBQSxRQUNBLFNBQUEsRUFDQSxZQUFBLEVBQ0EsT0FDQSxLQUFBLElBQ0EsUUFBQSxJQUNBLE1BQUEsSUFDQSxZQUFBLEtBRUEsWUFBQSxFQUFBLGlCQUFBLGtCQUNBLFdBQUEsWUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FLQSxFQUFBLFNBQUEsR0FFQSxFQUFBLE9BQUEsU0FBQSxTQUFBLEdBRUEsU0FBQSxHQUNBLEVBQUEsbUJBQUEsS0FJQSxFQUFBLE9BQUEsU0FBQSxFQUFBLFFBQUEsR0FBQSxFQUVBLEVBQUEsZUFBQSxXQUNBLEVBQUEsV0FBQSxFQUFBLFVBQ0EsRUFBQSxxQkFBQSxTQUtBLFVBQUEsVUFBQSwwQkFBQSxTQUFBLEdBQ0EsT0FDQSxTQUFBLEtBQ0EsU0FBQSxFQUNBLFlBQUEsRUFDQSxRQUFBLFNBQ0EsWUFBQSxFQUFBLGlCQUFBLG1CQUNBLEtBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsUUFBQSxFQUNBLEVBQUEsV0FBQSxXQUNBLEVBQUEsYUFDQSxFQUFBLFFBQUEsRUFBQSxRQUVBLEVBQUEsZUFBQSxXQUNBLEVBQUEsa0JBRUEsRUFBQSxVQUFBLEVBQUEsYUFJQSxVQUFBLFdBQUEsMEJBQUEsU0FBQSxHQUNBLE9BQ0EsU0FBQSxLQUNBLFNBQUEsRUFDQSxZQUFBLEVBQ0EsUUFBQSxTQUNBLFlBQUEsRUFBQSxpQkFBQSxvQkFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLFVBQUEsRUFBQSxnQkNsRUEsSUFBQSxTQUFBLFNBQUEscUJBQUEsVUFDQSxrQkFBQSxRQUFBLFFBQUEsT0FBQSxHQUFBLElBQ0Esb0JBQUEsa0JBQUEsTUFBQSxPQUFBLEVBRUEsU0FBQSxPQUFBLGVBQ0EsUUFBQSwyQkFBQSxXQUNBLE9BQ0EsaUJBQUEsb0JBQUEiLCJmaWxlIjoiZG9ja0NvbnRyb2wubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgZ21lc3phcm9zIG9uIDgvNS8yMDE0LlxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ0RvY2tDb250cm9sJywgWydBdHRyaWJ1dGUuRGlyZWN0aXZlcyddKVxyXG4gICAgLmNvbnN0YW50KCckYWxpZ25tZW50Jywge1xyXG4gICAgICAgIGhvcml6b250YWw6IFwiaG9yaXpvbnRhbFwiLFxyXG4gICAgICAgIHZlcnRpY2FsOiBcInZlcnRpY2FsXCIsXHJcbiAgICAgICAgbWlkZGxlOiBcIm1pZGRsZVwiXHJcbiAgICB9KVxyXG4gICAgLmNvbnN0YW50KCckb3JpZW50YXRpb24nLCB7XHJcbiAgICAgICAgbGVmdDogXCJsZWZ0XCIsXHJcbiAgICAgICAgcmlnaHQ6IFwicmlnaHRcIixcclxuICAgICAgICB0b3A6IFwidG9wXCIsXHJcbiAgICAgICAgYm90dG9tOiBcImJvdHRvbVwiLFxyXG4gICAgICAgIGNlbnRlcjogXCJjZW50ZXJcIlxyXG4gICAgfSlcclxuICAgIC5kaXJlY3RpdmUoJ2RvY2snLCBbXCJEb2NrQ29udHJvbC5QYXRoU2VydmljZVwiLCBmdW5jdGlvbiAoJHBhdGgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0FFJyxcclxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICRwYXRoLnRlbXBsYXRlc0Jhc2VVcmwgKyAnZG9jay50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICAgICAgc2l6ZUNoYW5nZWQ6ICc9J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRG9ja0N0cmwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9mZnNldCA9IF9hYnNvbHV0ZU9mZnNldCgkKCcucGFuZWwtY29udGFpbmVyJykpO1xyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIF9hYnNvbHV0ZU9mZnNldChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvcCA9IDAsIGxlZnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQub2Zmc2V0KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcCArPSBlbGVtZW50Lm9mZnNldCgpLnRvcCB8fCAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCArPSBlbGVtZW50Lm9mZnNldCgpLmxlZnQgfHwgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IHdoaWxlIChlbGVtZW50Lmxlbmd0aCA+IDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHRvcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogbGVmdFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGdtZXN6YXJvcyBvbiA5LzUvMjAxNC5cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdBdHRyaWJ1dGUuRGlyZWN0aXZlcycsIFtdKVxyXG4gICAgLmRpcmVjdGl2ZSgnd2lkdGgnLCBbZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKHt3aWR0aDogYXR0cnMud2lkdGh9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSlcclxuICAgIC5kaXJlY3RpdmUoJ2hlaWdodCcsIFtmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5jc3Moe2hlaWdodDogYXR0cnMuaGVpZ2h0fSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pXHJcbiAgICAuZGlyZWN0aXZlKCdtaW5XaWR0aCcsIFtmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5jc3Moe21pbldpZHRoOiBhdHRycy5taW5XaWR0aH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWluSGVpZ2h0JywgW2Z1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyh7bWluSGVpZ2h0OiBhdHRycy5taW5IZWlnaHR9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSlcclxuICAgIC5kaXJlY3RpdmUoJ2VsZW1lbnRMZWF2ZScsIFtmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHZhciBkb21DbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihldmVudC50YXJnZXQgPT09IGVsZW1lbnRbMF0gfHwgJChldmVudC50YXJnZXQpLmNsb3Nlc3QoZWxlbWVudCkubGVuZ3RoID4gMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGV2YWwoYXR0cnMuZWxlbWVudExlYXZlLCB7ICRldmVudDogZXZlbnQgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudCkudW5iaW5kKCdjbGljaycsIGRvbUNsaWNrSGFuZGxlcik7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRDbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5jbGljayhkb21DbGlja0hhbmRsZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xpY2soZWxlbWVudENsaWNrSGFuZGxlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vRGlzcG9zaW5nXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS51bmJpbmQoJ2NsaWNrJywgZG9tQ2xpY2tIYW5kbGVyKTtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnVuYmluZCgnY2xpY2snLCBlbGVtZW50Q2xpY2tIYW5kbGVyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBnbWVzemFyb3Mgb24gOC81LzIwMTQuXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnRG9ja0NvbnRyb2wnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0RvY2tDdHJsJywgWyckc2NvcGUnLCAnJG9yaWVudGF0aW9uJywgJyRhbGlnbm1lbnQnLCBmdW5jdGlvbiAoJHNjb3BlLCAkb3JpZW50YXRpb24sICRhbGlnbikge1xyXG4gICAgICAgIHRoaXMuYWRkUGFuZWwgPSBmdW5jdGlvbiAocGFuZWwpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnBhbmVscy5wdXNoKHBhbmVsKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGFuZWxEb2NrZWRDaGFuZ2VkID0gZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgICAgIGlmIChwYW5lbC5kb2NrZWQpIHtcclxuICAgICAgICAgICAgICAgIHBhbmVsLnNldFRvRGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF9zZXRTaXplKHBhbmVsKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGFuZWxDb2xsYXBzZUNoYW5nZWQgPSBmdW5jdGlvbiAocGFuZWwpIHtcclxuICAgICAgICAgICAgLypsaW5xKCRzY29wZS5wYW5lbHMpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtICE9PSBwYW5lbCAmJiBpdGVtLm9yaWVudGF0aW9uID09PSBwYW5lbC5vcmllbnRhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY29sbGFwc2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7Ki9cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBfc2V0U2l6ZShyZWZQYW5lbCkge1xyXG4gICAgICAgICAgICBsaW5xKCRzY29wZS5wYW5lbHMpLndoZXJlKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5hbGlnbiAhPT0gcmVmUGFuZWwuYWxpZ247XHJcbiAgICAgICAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXBhbmVsLmRvY2tlZCB8fCAocGFuZWwuZG9ja2VkICYmIHBhbmVsLmluZGV4IDwgcmVmUGFuZWwuaW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFuZWxbcmVmUGFuZWwub3JpZW50YXRpb25dID0gcmVmUGFuZWwuZG9ja2VkID8gcmVmUGFuZWwuc2l6ZSA6IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkc2NvcGUuc2l6ZUNoYW5nZWQgPSAhJHNjb3BlLnNpemVDaGFuZ2VkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvcmllbnRhdGlvbiA9ICRvcmllbnRhdGlvbjtcclxuICAgICAgICAkc2NvcGUucGFuZWxzID0gW107XHJcbiAgICAgICAgJHNjb3BlLmRyYWcgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIHBhbmVsID0gbGlucSgkc2NvcGUucGFuZWxzKS5maXJzdE9yRGVmYXVsdChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZHJhZ2dpbmc7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoIXBhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3dpdGNoIChwYW5lbC5hbGlnbikge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAkYWxpZ24uaG9yaXpvbnRhbDpcclxuICAgICAgICAgICAgICAgICAgICBwYW5lbC5zaXplID0gcGFuZWwub3JpZW50YXRpb24gPT09ICRvcmllbnRhdGlvbi5sZWZ0ID8gZXZlbnQuY2xpZW50WCAtICRzY29wZS5vZmZzZXQubGVmdCArIDUgOiAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLndpZHRoKCkgLSBldmVudC5jbGllbnRYIC0gJHNjb3BlLm9mZnNldC5sZWZ0ICsgNTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJGFsaWduLnZlcnRpY2FsOlxyXG4gICAgICAgICAgICAgICAgICAgIHBhbmVsLnNpemUgPSBwYW5lbC5vcmllbnRhdGlvbiA9PT0gJG9yaWVudGF0aW9uLnRvcCA/IGV2ZW50LmNsaWVudFkgLSAkc2NvcGUub2Zmc2V0LmxlZnQgOiAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmhlaWdodCgpIC0gZXZlbnQuY2xpZW50WSAtICRzY29wZS5vZmZzZXQubGVmdDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsaW5xKCRzY29wZS5wYW5lbHMpXHJcbiAgICAgICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF9zZXRTaXplKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmVuZERyYWcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGxpbnEoJHNjb3BlLnBhbmVscykuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5kcmFnZ2luZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgfV0pOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGdtZXN6YXJvcyBvbiA4LzUvMjAxNC5cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdEb2NrQ29udHJvbCcpXHJcbiAgICAuY29udHJvbGxlcignUGFuZWxDdHJsJywgWyckc2NvcGUnLCAnJGFsaWdubWVudCcsICckb3JpZW50YXRpb24nLCBmdW5jdGlvbiAoJHNjb3BlLCAkYWxpZ24sICRvcmllbnRhdGlvbikge1xyXG5cclxuICAgICAgICB0aGlzLnRvZ2dsZURvY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVEb2NrKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy50b2dnbGVDb2xsYXBzZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUNvbGxhcHNlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRIZWFkZXIgPSBmdW5jdGlvbiAoaGVhZGVyKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5oZWFkZXIgPSBoZWFkZXI7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5oYXNIZWFkZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuaGVhZGVyICE9PSBcIlwiO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEFsaWduKG9yaWVudGF0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUub3JpZW50YXRpb24gPT09ICRvcmllbnRhdGlvbi5sZWZ0IHx8ICRzY29wZS5vcmllbnRhdGlvbiA9PT0gJG9yaWVudGF0aW9uLnJpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJGFsaWduLmhvcml6b250YWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCRzY29wZS5vcmllbnRhdGlvbiA9PT0gJG9yaWVudGF0aW9uLnRvcCB8fCAkc2NvcGUub3JpZW50YXRpb24gPT09ICRvcmllbnRhdGlvbi5ib3R0b20pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkYWxpZ24udmVydGljYWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICRhbGlnbi5taWRkbGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUudG9nZ2xlRG9jayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmRvY2tlZCA9ICEkc2NvcGUuZG9ja2VkO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS4kYWxpZ24gPSAkYWxpZ247XHJcbiAgICAgICAgJHNjb3BlLiRvcmllbnRhdGlvbiA9ICRvcmllbnRhdGlvbjtcclxuICAgICAgICAkc2NvcGUuZG9ja2VkID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLmNvbGxhcHNlZCA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5kcmFnZ2luZyA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5oZWFkZXIgPSBcIlwiO1xyXG4gICAgICAgICRzY29wZS5hbGlnbiA9IGdldEFsaWduKCRzY29wZS5vcmllbnRhdGlvbik7XHJcbiAgICAgICAgaWYgKCRzY29wZS5vcmllbnRhdGlvbiA9PT0gJG9yaWVudGF0aW9uLmNlbnRlcikge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWxpZ24gPSAkYWxpZ24ubWlkZGxlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLnN0YXJ0RHJhZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmRyYWdnaW5nID0gdHJ1ZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUucGFuZWxFeHBhbmQgPSBmdW5jdGlvbiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb2xsYXBzZWQgPSBmYWxzZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUucGFuZWxMZWF2ZSA9IGZ1bmN0aW9uICgkZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKCEkc2NvcGUuZG9ja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29sbGFwc2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5zZXRUb0RlZmF1bHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5sZWZ0ID0gJyc7XHJcbiAgICAgICAgICAgICRzY29wZS5yaWdodCA9ICcnO1xyXG4gICAgICAgICAgICAkc2NvcGUudG9wID0gJyc7XHJcbiAgICAgICAgICAgICRzY29wZS5ib3R0b20gPSAnJztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuc2V0U3R5bGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogJHNjb3BlLmFsaWduID09PSAkYWxpZ24uaG9yaXpvbnRhbCA/ICRzY29wZS5zaXplIDogJycsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6ICRzY29wZS5hbGlnbiA9PT0gJGFsaWduLnZlcnRpY2FsID8gJHNjb3BlLnNpemUgOiAnJyxcclxuICAgICAgICAgICAgICAgIGxlZnQ6ICRzY29wZS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgcmlnaHQ6ICRzY29wZS5yaWdodCxcclxuICAgICAgICAgICAgICAgIHRvcDogJHNjb3BlLnRvcCxcclxuICAgICAgICAgICAgICAgIGJvdHRvbTogJHNjb3BlLmJvdHRvbVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICB9XSk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgZ21lc3phcm9zIG9uIDgvNS8yMDE0LlxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ0RvY2tDb250cm9sJylcclxuICAgIC5kaXJlY3RpdmUoJ3BhbmVsJywgW1wiRG9ja0NvbnRyb2wuUGF0aFNlcnZpY2VcIiwgZnVuY3Rpb24gKCRwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBRScsXHJcbiAgICAgICAgICAgIHJlcXVpcmU6ICdeZG9jaycsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICAgICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgICAgICBzaXplOiAnPScsXHJcbiAgICAgICAgICAgICAgICBtaW5TaXplOiAnPScsXHJcbiAgICAgICAgICAgICAgICBpbmRleDogJ0AnLFxyXG4gICAgICAgICAgICAgICAgb3JpZW50YXRpb246ICdAJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJHBhdGgudGVtcGxhdGVzQmFzZVVybCArICdwYW5lbC50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUGFuZWxDdHJsJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWxlbWVudCwgYXR0cnMsIGRvY2tDdHJsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyRzY29wZS5zaXplID0gcGFyc2VGbG9hdCgkc2NvcGUuc2l6ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vQWRkIHBhbmVsIHRvIHRoZSBkb2NrXHJcbiAgICAgICAgICAgICAgICBkb2NrQ3RybC5hZGRQYW5lbCgkc2NvcGUpO1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ2RvY2tlZCcsIGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2NrQ3RybC5wYW5lbERvY2tlZENoYW5nZWQoJHNjb3BlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZG9ja2VkID0gYXR0cnMuZG9ja2VkID09PSBcInRydWVcIiA/IHRydWUgOiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudG9nZ2xlQ29sbGFwc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbGxhcHNlZCA9ICEkc2NvcGUuY29sbGFwc2VkO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY2tDdHJsLnBhbmVsQ29sbGFwc2VDaGFuZ2VkKCRzY29wZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKVxyXG4gICAgLmRpcmVjdGl2ZSgnaGVhZGVyJywgW1wiRG9ja0NvbnRyb2wuUGF0aFNlcnZpY2VcIiwgZnVuY3Rpb24gKCRwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBRScsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICAgICAgICAgIHJlcXVpcmU6ICdecGFuZWwnLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJHBhdGgudGVtcGxhdGVzQmFzZVVybCArICdoZWFkZXIudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWxlbWVudCwgYXR0cnMsIHBhbmVsQ3RybCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRvY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZURvY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFuZWxDdHJsLnRvZ2dsZURvY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZG9ja2VkID0gISRzY29wZS5kb2NrZWQ7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUNvbGxhcHNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhbmVsQ3RybC50b2dnbGVDb2xsYXBzZSgpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHBhbmVsQ3RybC5zZXRIZWFkZXIoZWxlbWVudC50ZXh0KCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKVxyXG4gICAgLmRpcmVjdGl2ZSgnY29udGVudCcsIFtcIkRvY2tDb250cm9sLlBhdGhTZXJ2aWNlXCIsIGZ1bmN0aW9uICgkcGF0aCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQUUnLFxyXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgICAgICAgICByZXF1aXJlOiAnXnBhbmVsJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICRwYXRoLnRlbXBsYXRlc0Jhc2VVcmwgKyAnY29udGVudC50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBwYW5lbEN0cmwpIHtcclxuICAgICAgICAgICAgICAgIHNjb3BlLmhhc0hlYWRlciA9IHBhbmVsQ3RybC5oYXNIZWFkZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgZ21lc3phcm9zIG9uIDEwLzYvMjAxNC5cclxuICovXHJcbnZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XHJcbnZhciBjdXJyZW50U2NyaXB0UGF0aCA9IHNjcmlwdHNbc2NyaXB0cy5sZW5ndGggLSAxXS5zcmM7XHJcbnZhciBkb2NrQ29udHJvbFJvb3RQYXRoID0gY3VycmVudFNjcmlwdFBhdGguc3BsaXQoXCJqcy9cIilbMF07XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnRG9ja0NvbnRyb2wnKVxyXG4gICAgLnNlcnZpY2UoXCJEb2NrQ29udHJvbC5QYXRoU2VydmljZVwiLCBbIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm57XHJcbiAgICAgICAgICAgIHRlbXBsYXRlc0Jhc2VVcmw6IGRvY2tDb250cm9sUm9vdFBhdGggKyBcInRlbXBsYXRlcy9cIlxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9